<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mask Animation</title>
    <link rel="shortcut icon" href="favicon.png" />
    
    <script type="text/javascript" src="js/jquery-3.5.1.min.js"></script>
    <script src="js/jquery.easeScroll.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/ScrollTrigger.min.js"></script>
    <!-- <script type="text/javascript" src="js/mask.js"></script> -->

    <link rel="stylesheet" href="css/mask.css"><!-- scss/mask.scss -->
</head>

<body class="hidden">
    <!-- MASK 1 -->
    <button type="button" class="effective">
        <div id="container">
            Make 
            <div id="flip">
                <div><div>work</div></div>
                <div><div>lifestyle</div></div>
                <div><div>everything</div></div>
            </div>
            Awesome!
        </div>
        <p id="clickMe">Click here.</p>
    </button>

    <div class="background">
        <video src="videos/brushstroke.mp4" id="video" type="video/mp4" loop></video>
        <div class="visual">
            <h1 class="block-effect" style="--td: 1.2s">
                <div class="block-reveal" style="--bc: #5B5753; --d: .1s">Block</div>
                <div class="block-reveal" style="--bc: #1D3242; --d: .5s">Revealing Effect</div>
            </h1>
        </div>

        <!-- <div id="section1" class="section"></div> -->
        <div id="section2" class="section">
            <div id="bg_change"></div>
            <h2 class="projectTitle">TITLE Sticky</h2>
            <ul class="showList">
                <li>
                    <div>1</div>
                </li>
                <li>
                    <div>2</div>
                </li>
                <li>
                    <div>3</div>
                </li>
                <li>
                    <div>4</div>
                </li>
            </ul>
        </div>

        <div id="section3" class="section">
            
        </div>

        
    </div>

    <script>
        // Intro
        const video = document.querySelector('#video');
        const effect = document.querySelector('.effective');
        const blockEffect = document.querySelectorAll('.block-reveal');
        effect.addEventListener('click', function () {
            effect.classList.add("on");
            video.muted = true;
            video.autoplay = true; 
            video.play();
            setTimeout(function(){
                effect.remove();
                blockEffect.forEach(function(block) {
                    block.classList.add("on");
                });
                document.querySelector('body').classList.remove('hidden');
                // scroll
                $("html").easeScroll({
                    frameRate: 150,
                    animationTime: 1000,
                    stepSize: 120,
                    pulseAlgorithm: 1,
                    pulseScale: 5,
                    pulseNormalize: 1,
                    accelerationDelta: 20,
                    accelerationMax: 1,
                    keyboardSupport: !0,
                    arrowScroll: 100
                });
            },1500)
        });

        gsap.registerPlugin(ScrollTrigger);

        document.querySelectorAll('.showList li').forEach((li, index) => {
            gsap.to(li, {
                scrollTrigger: {
                    trigger: li,
                    start: "top 40%",
                    end: "bottom bottom",
                    onEnter: () => li.classList.add('active'),
                    onLeaveBack: () => li.classList.remove('active')
                }
            });
        });


        $(function(){
            indexSet();
            $(window).on('load',function(){
                indexSet();
            });
            $(window).scroll(function(){
                indexSet();
            })
            function indexSet(){
                var now_loc = $(this).scrollTop();
                var cardLoc = $('#section2').offset().top;
                if(now_loc >= cardLoc - 400){
                    $('#bg_change').fadeIn();
                }else{
                    $('#bg_change').fadeOut();
                }
            }
        });
    </script>
</body>

</html>